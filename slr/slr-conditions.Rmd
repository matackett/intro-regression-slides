---
title: "Simple Linear Regression"
subtitle: "Assessing Conditions"
author: "Dr. Maria Tackett"
output:
  xaringan::moon_reader:
    mathjax: "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML"
    css: "slides.css"
    logo: "img/introregression-sticker.png"
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: 4:3
      slideNumberFormat: "%current%"
    seal: false #make custom title slide
editor_options: 
  chunk_output_type: console
---

```{r child = "setup.Rmd"}
```

class: title-slide 

<br><br>

# Simple Linear Regression 
## Assessing Conditions

<br><br><br>

### Dr. Maria Tackett

---

## Topics 

--

- Identify the conditions for simple linear regression: 
  
--

- Use plots of the residuals to assess the conditions. 

```{r packages, echo = F}
library(tidyverse)
library(broom)
library(knitr)
library(kableExtra)
library(patchwork)
library(fivethirtyeight) #fandango dataset
```

```{r data}
movie_scores <- fandango %>%
  rename(critics = rottentomatoes, 
         audience = rottentomatoes_user)
```

---

## Movie ratings data 

The data set contains the "Tomatometer" score (**`critics`**) and audience score (**`audience`**) for 146 movies rated on rottentomatoes.com. 

```{r}
ggplot(data = movie_scores, mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) + 
  labs(x = "Critics Score" , 
       y = "Audience Score") +
  theme_bw()
```


---

class: middle 

We fit a line to describe the relationship between the critics score and audience score.


```{r}
model <- lm(audience ~ critics, data = movie_scores)
```

```{r}
model %>%
  tidy() %>%
  kable(format = "html", digits = 3)
```


```{r}
ggplot(data = movie_scores, mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) + 
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(x = "Critics Score" , 
       y = "Audience Score") +
  theme_bw()
```

---

## Model conditions

--

1. .vocab[Linearity: ]There is a linear relationship between the response and predictor variable.

--

2. .vocab[Constant Variance: ]The variability of the errors is equal for all values of the predictor variable.

--

3. .vocab[Normality: ]The errors follow a normal distribution.

--

4. .vocab[Independence: ]The errors are independent from one another.

---

class: middle, center

.eq[
$$\text{residual} = y - \hat{y}$$ 
]

---

### Plot of residuals vs. fitted values

```{r}
movie_aug <- augment(model)
```

```{r}
ggplot(data = movie_aug, aes(x = .fitted, y = .resid)) + 
  geom_point(alpha = 0.7) + 
  geom_hline(yintercept = 0, color = "red") +
  labs(x = "Fitted values", 
       y = "Residuals") +
  theme_bw()
```

---

## Assessing linearity

.vocab[Linearity: ]There is a linear relationship between the response and predictor variable.

--

```{r}
ggplot(data = movie_aug, aes(x = .fitted, y = .resid)) + 
  geom_point() + 
  geom_hline(yintercept = 0, color = "red") +
  labs(x = "Fitted values", 
       y = "Residuals") +
  theme_bw()
```

--

`r emo::ji("white_check_mark")` There is no distinguishable pattern or structure. The residuals are randomly scattered. 

---

### Assessing constant variance

.vocab[Constant Variance: ]The variability of the errors is equal for all values of the predictor variable.

--

```{r}
ggplot(data = movie_aug, aes(x = .fitted, y = .resid)) + 
  geom_point(alpha = 0.7) + 
  geom_hline(yintercept = 0, color = "red") +
  labs(x = "Fitted values", 
       y = "Residuals") +
  theme_bw()
```

--

`r emo::ji("white_check_mark")` The vertical spread of the residuals is relatively constant.

---

### Violations 

[INCLUDE SOME PLOTS!]

- No linear
- Constant Variance

---

### Normal quantile plot

<font class = "midi">
A <font class = "vocab">normal quantile plot</font> is a scatterplot of the quantiles of the observed data (x-axis) versus the theoretical quantiles from a sample of the same size that is perfectly normal.
</font>

--

```{r}
norm_data <- tibble(x = rnorm(1000,0,1))

p1 <- ggplot(norm_data, aes(x = x)) +
  geom_histogram()

p2 <- ggplot(norm_data, aes(sample = x)) +
  stat_qq() + 
  stat_qq_line()

p1 + p2
```

--

<font class = "midi">
If the distribution of the observed data is approximately normal, the points will follow a straight diagonal line.
</font>

---

## Assessing normality

.vocab[Normality: ]The errors follow a normal distribution.

--

```{r}
resid_hist <- ggplot(data = movie_aug, aes(x = .resid)) + 
  geom_histogram() + 
  labs(x = "Residuals") +
  theme_bw()

resid_qq <- ggplot(data = movie_aug, aes(sample = .resid)) + 
  stat_qq() + 
  stat_qq_line() +
  labs(x = "Observed quantiles", 
       y= "Theoretical quantiles") +
  theme_bw()

resid_hist + resid_qq
```

--

`r emo::ji("white_check_mark")` Points follow a straight diagonal line on the normal quantile plot.

---

### Assessing independence

.vocab[Independence: ]The errors are independent from one another.

--

- We can often assess the independence assumption based on the context of the data and how the observations were collected.

--

- If the data were collected in a particular order (e.g., over time), you can examine a scatterplot of the residuals versus order in which the data were collected. 

---

### In practice 

As you assess the model conditions, ask if any observed deviation from the model conditions provide sufficient evidence that

`r emo::ji("one")` a different model should be proposed. 

`r emo::ji("one")` conclusions drawn from the model should be used with caution.

--

If not, the conditions are satisfied sufficiently enough to proceed.

---

## Recap

--

- Identified the conditions for simple linear regression: 
  1. Linearity
  1. Constant Variance
  1. Normality
  1. Independence
--

- Used plots of the residuals to assess the conditions. 

---

class: title-slide 

<br><br>

# Simple Linear Regression 
## Assessing Conditions 

<br><br><br>

### Dr. Maria Tackett

